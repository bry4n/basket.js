(function(a,b){function c(){var a="basket-",c=function(a,b){try{return(a=localStorage).setItem(b,a),a.removeItem(b),!0}catch(c){}}(),e=[],f=0,g=0,h=[],i=function(a,b){b=[b="Msxml2.XMLHTTP",b+".3.0",b+".6.0"];do try{return a=b.pop(),new(a?ActiveXObject:XMLHttpRequest)(a)}catch(c){}while(a)},j=function(a,b){var c=i();c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send()},k=function(a){var c=b.createElement("script"),e=b.createDocumentFragment();c.defer=!0,head=b.head||b.getElementsByTagName("head")[0],c.appendChild(b.createTextNode(a)),e.appendChild(c),head.appendChild(e)},l=function(a){var b,c,d,g;if(f>=a)for(c=0;c<e.length;c++){b=e[c];if(!b)continue;e[c]=null,k(b),f++;for(d=c;d<f;d++)if(g=h[d])console.log("in callbacks"),h[d]=null,g()}};return{add:function(b){var d=a+b,f=e.length,h=g;return e[f]=null,c&&localStorage.getItem(d)?(e[f]=localStorage.getItem(d),l(h)):j(b,function(a){c&&localStorage.setItem(d,a),e[f]=a,l(h)}),this},wait:function(a){return g=e.length,a&&(f>=g-1?a():h[g-1]=a),this}}}a.basket=c()})(this,document)